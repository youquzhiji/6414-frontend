var h0=Object.defineProperty;var p0=(e,t,s)=>t in e?h0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var c=(e,t,s)=>(p0(e,typeof t!="symbol"?t+"":t,s),s);import{d as t0,c as u,a as i,b as y,w as V,F as P,r as v,o as d,e as s0,t as X,l as f0,p as _0,f as o0,m as m0,g as v0,h as g0,i as y0,s as b0,P as S,O as T,V as O,j as w0,n as M,k as H,q as m,u as L,v as w,x as I,y as R,S as $0,D as C0,z as C,E as Q,A as D,B as S0,C as k0,G as D0,H as A0,I as F0,J as a0,K as T0,L as O0,M as L0,N as x0}from"./vendor.0b41516a.js";const P0=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}};P0();const M0=i("i",{class:"fa-solid fa-house"},null,-1),I0=i("span",null,"Home",-1),R0=i("i",{class:"fa-solid fa-circle-info"},null,-1),q0=i("span",null,"About",-1),B0=i("i",{class:"fa-solid fa-cog"},null,-1),W0=i("span",null,"Settings",-1),V0=t0({setup(e){return(t,s)=>{const a=v("router-link"),o=v("router-view");return d(),u(P,null,[i("div",{id:"nav",class:"fbox-h fcenter unselectable anim",onDragstart:s[0]||(s[0]=n=>n.preventDefault())},[y(a,{class:"rlink",to:"/"},{default:V(()=>[M0,I0]),_:1}),y(a,{class:"rlink",to:"/about"},{default:V(()=>[R0,q0]),_:1}),y(a,{class:"rlink",to:"/settings"},{default:V(()=>[B0,W0]),_:1})],32),y(o)],64)}}});class n0{constructor(t){c(this,"el");c(this,"ctx");c(this,"w");c(this,"h");this.el=t,this.ctx=t.getContext("2d");const s=window.getComputedStyle(t);this.w=t.width=parseInt(s.width.replace("px","")),this.h=t.height=parseInt(s.height.replace("px",""))}}class Z{constructor(t,s,a){c(this,"key");c(this,"desc");c(this,"def");c(this,"type");c(this,"cache");this.key=t,this.desc=s,this.def=a,this.type=typeof a,this.cache=this.val_uncached}get val_uncached(){const t=localStorage.getItem(this.key);return t===null?this.def:JSON.parse(t)}get val(){return this.cache?this.cache:this.cache=this.val_uncached}set val(t){localStorage.setItem(this.key,JSON.stringify(t)),this.cache=t}reset(){localStorage.removeItem(this.key),this.cache=this.def}get modified(){return this.val!=this.def}}const z=[new Z("spec.local","**Compute spectrogram locally** - enable if you have *really* bad internet like <1 MB/s",!1),new Z("backend.url","**Backend host** - you can run your own backend to speed up things! [read more]()","http://localhost:8000")],H0=z.reduce((e,t)=>(e[t.key]=t,e),{});function r0(e){return H0[e]}function j0(e){let t=0,s=0;for(let a=0;a<e.length;a++)isNaN(e[a])||(t+=e[a],s++);return s==0?null:t/s}function G(e){let t=e[0],s=e[0];for(let a=0;a<e.length;a++)e[a]<t&&(t=e[a]),e[a]>s&&(s=e[a]);return[t,s]}class N0{constructor(t,s,a=!0){c(this,"res");c(this,"r");c(this,"g");c(this,"b");if(this.res=s,this.r=new Uint8Array(s+1),this.g=new Uint8Array(s+1),this.b=new Uint8Array(s+1),a){const o=Math.log2(s);for(let n=0;n<=s;n++)[this.r[n],this.g[n],this.b[n]]=t(Math.log2(n)/o).rgb()}else for(let o=0;o<=s;o++)[this.r[o],this.g[o],this.b[o]]=t(o/s).rgb()}get(t){const s=Math.round(t*this.res);return[this.r[s],this.g[s],this.b[s]]}}function E0(e,t){const s=new Float32Array(s0.Buffer.from(e,"base64").buffer),a=t[0],o=s.length/a,n=["pitch","f1","f2","f3"],r={};for(let l=0;l<a;l++)r[n[l]]=s.slice(o*l,o*(l+1));return r}function U0(e,t){const s=new Float32Array(s0.Buffer.from(e,"base64").buffer),a=t[0],o=s.length/a,n=[];for(let r=0;r<a;r++)n.push(s.slice(o*r,o*(r+1)));return n}class j{constructor(){c(this,"start");this.reset()}reset(){this.start=performance.now()}log(...t){console.log(`${(performance.now()-this.start).toFixed(0)} ms -`,...t),this.reset()}}async function z0(e,t={}){var o,n,r;const s=new URL(e.startsWith("http")?e:r0("backend.url").val+e);s.search=new URLSearchParams((o=t.params)!=null?o:{}).toString();const a=(n=t.args)!=null?n:{};return"method"in a||(a.method=(r=t.method)!=null?r:"GET"),t.file&&((!t.body||!(t.body instanceof FormData))&&(t.body=new FormData),t.body.append("file",t.file),a.method=="GET"&&(a.method="POST")),t.body&&(a.body=t.body),await fetch(s.toString(),a)}function g(e){return 2595*Math.log10(1+e/700)}function G0(e){return _0(10,e.div(2595)).sub(1).mul(700)}function K0(e,t){const s=t/e,a=e/2+1,o=new Float32Array(a);for(let n=0;n<a;n++)o[n]=n*s;return o}function Y0(e,t,s){const a=t<1?0:g(t),o=g(s),n=[];for(let r=100;r<=Math.min(s,1e3);r+=100)n.push([r,g(r)/(o-a)+a]);for(let r=1e3;r<=Math.min(s,4e3);r+=200)n.push([r,g(r)/(o-a)+a]);for(let r=4e3;r<=s;r+=500)n.push([r,g(r)/(o-a)+a]);return n}function J0(e,t,s=128,a){typeof a=="undefined"&&(a=e/2);const o=Array(s),n=X(K0(t,e),"float32"),r=X0(s+2,0,a),l=Q0(r.dataSync()),p=Z0(r.dataSync(),n.dataSync());for(let f=0;f<s;f++){const B=p.slice(f,1).mul(-1).div(l[f]),W=p.slice(f+2,1).div(l[f+1]);o[f]=m0(0,v0(B,W)).dataSync()}const h=g0(2).div(r.slice(2,s).sub(r.slice(0,s)));return o0(o).transpose().mul(h).transpose()}function X0(e=128,t=0,s=11025){return G0(f0(g(t),g(s),e))}function Q0(e){const t=new Float32Array(e.length-1);for(let s=0;s<e.length-1;s++)t[s]=e[s+1]-e[s];return t}function Z0(e,t){const s=[];for(let a=0;a<e.length;a++){s.push(new Float32Array(t.length));for(let o=0;o<t.length;o++)s[a][o]=e[a]-t[o]}return o0(s)}async function i0(e,t,s=512,a=2048){const o=b0.stft(X(e),a,s).abs(),r=J0(t,a).dot(o.transpose()).transpose(),l=await r.data(),p=[],[h,_]=r.shape;for(let f=0;f<h;f++)p.push(l.subarray(f*_,(f+1)*_));return p}function e0(e,t,s,a,o,n,r,l,p=255){const h=(o-s-1)*a+t;e[h]=n,e[h+1]=r,e[h+2]=l,e[h+3]=p}class ee extends n0{async drawAudio(t){const s=new j,a=await i0(t.getChannelData(0),16e3);return s.log("Spectrogram - Mel STFT calculation done"),console.log(a),await this.drawData(a,16e3)}async drawData(t,s){const a=new j;this.el.width=this.w=t.length*2;const[o,n]=G(t.flatMap(f=>G(f))),r=n-o,l=this.ctx.createImageData(this.w,this.h),p=l.data,h=this.w*4,_=new N0(y0.scale(["#232323","#4F1879","#B43A78","#F98766","#FCFAC0"]),1e3);for(let f=0;f<t.length;f++){const B=t[f],W=f*4;for(let x=0;x<this.h;x++){const u0=B[Math.floor(x/this.h*B.length)],k=_.get((u0-o)/r);e0(p,2*W,x,h,this.h,k[0],k[1],k[2]),e0(p,2*W+4,x,h,this.h,k[0],k[1],k[2])}}return this.ctx.putImageData(l,0,0),this.ctx.closePath(),a.log("Spectrogram - Drawing done."),Y0(this.h,0,8e3)}async drawLine(t,s,a,o=1){console.log("Drawing line..."),console.log(t.length);const n=t.length/this.w;console.log(n);let r=null;const l=g(8e3);t=t.map(p=>this.h-g(p)/l*this.h),this.ctx.beginPath();for(let p=0;p<this.w;p++){const h=j0(t.subarray(n*p,Math.ceil(n*(p+1))));h!=null&&(r!=null?this.ctx.lineTo(p,h):this.ctx.moveTo(p,h)),r=h}this.ctx.lineWidth=o,this.ctx.strokeStyle=a,this.ctx.stroke(),this.ctx.closePath()}}var b=(e,t)=>{const s=e.__vccOpts||e;for(const[a,o]of t)s[a]=o;return s},te=Object.defineProperty,se=Object.getOwnPropertyDescriptor,E=(e,t,s,a)=>{for(var o=a>1?void 0:a?se(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&te(t,s,o),o};let A=class extends O{constructor(){super(...arguments);c(this,"spec");c(this,"sr");c(this,"freqArrays");c(this,"spectrogramCanvas");c(this,"numberFormat",Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}));c(this,"ticks",null);c(this,"widthScale",1);c(this,"scrollLocation",0);c(this,"minWidthScale",1)}async mounted(){const e=new j;e.log(`Spectrogram mounting... ${this.spec.length} * ${this.spec[0].length}, sr=${this.sr}`),this.spectrogramCanvas=new ee(this.$refs.spCanvas),await this.spectrogramCanvas.drawData(this.spec,this.sr).then(a=>this.ticks=a),e.log("Data draw complete"),this.freqArrays&&(console.log("Frequency overlays updating"),await this.spectrogramCanvas.drawLine(this.freqArrays.pitch,.032,"#64fbff",3),await this.spectrogramCanvas.drawLine(this.freqArrays.f1,.032,"#7bff4f",2),await this.spectrogramCanvas.drawLine(this.freqArrays.f2,.032,"#93ffb9",2),await this.spectrogramCanvas.drawLine(this.freqArrays.f3,.032,"#4ffff9",1),e.log("Lines drawn"));const t=this.$refs.spCanvas.getBoundingClientRect().width,s=this.$refs.spCanvas.parentElement.getBoundingClientRect().width;t*this.widthScale<s&&(this.widthScale=s/t,this.minWidthScale=this.widthScale),e.log("Spectrogram mounted!")}get width(){return this.$refs.spCanvas.width}wheel(e){const t=this.widthScale,s=e.target,a=s.getBoundingClientRect();let o=e.detail<0||e.deltaY>0?1:-1;if(e.shiftKey&&(o/=10),e.ctrlKey)this.widthScale-=o/2;else{const n=s.parentElement.getBoundingClientRect();let r=o*20;r<0?r=Math.max(r,a.left-n.left):r=Math.min(r,a.right-n.right),this.scrollLocation+=r}if(this.widthScale=Math.max(this.minWidthScale,this.widthScale),t!=this.widthScale){const n=e.clientX-(a.left+a.width/2),r=n/t*this.widthScale-n;this.scrollLocation+=r}}};E([S()],A.prototype,"spec",2);E([S()],A.prototype,"sr",2);E([S()],A.prototype,"freqArrays",2);A=E([T({components:{}})],A);const oe=A,ae=e=>(I("data-v-343d36d0"),e=e(),R(),e),ne={class:"spectrogram f-grow1 fbox-h"},re={class:"canvas-wrapper"},ie={key:0,class:"y-ticks"},le=ae(()=>i("div",{class:"tick-line"},null,-1));function ce(e,t,s,a,o,n){return d(),u("div",ne,[i("div",re,[i("canvas",{ref:"spCanvas",onWheel:t[0]||(t[0]=w0((...r)=>e.wheel&&e.wheel(...r),["prevent"])),style:M({transform:`translateX(${-e.scrollLocation}px) scaleX(${e.widthScale})`})},null,36)]),e.ticks?(d(),u("div",ie,[(d(!0),u(P,null,H(e.ticks,r=>(d(),u("div",{class:"tick unselectable fbox-h",style:M({top:`${(1-r[1])*100}%`})},[le,L(" "+w(e.numberFormat.format(r[0])),1)],4))),256))])):m("",!0)])}var de=b(oe,[["render",ce],["__scopeId","data-v-343d36d0"]]),ue="/assets/loading.21b6d724.svg";var he=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,fe=(e,t,s,a)=>{for(var o=a>1?void 0:a?pe(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&he(t,s,o),o};let K=class extends O{};K=fe([T({components:{}})],K);const _e=K,l0=e=>(I("data-v-02c9bba4"),e=e(),R(),e),me={id:"Loading"},ve=l0(()=>i("img",{src:ue,alt:"loading"},null,-1)),ge=l0(()=>i("div",{class:"text"},"Loading Meow~",-1)),ye=[ve,ge];function be(e,t,s,a,o,n){return d(),u("div",me,ye)}var we=b(_e,[["render",be],["__scopeId","data-v-02c9bba4"]]);const $e="#fff4eb";class Ce extends n0{drawAudio(t){const s=t.getChannelData(0),a=t.length/this.w,o=this.h/2;for(let n=0;n<this.w;n++){const[r,l]=G(s.subarray(n*a,(n+1)*a));this.ctx.strokeStyle=$e,this.ctx.moveTo(n,o-l*o),this.ctx.lineTo(n,o-r*o),this.ctx.stroke()}}}var Se=Object.defineProperty,ke=Object.getOwnPropertyDescriptor,c0=(e,t,s,a)=>{for(var o=a>1?void 0:a?ke(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&Se(t,s,o),o};let N=class extends O{constructor(){super(...arguments);c(this,"audio");c(this,"waveformCanvas")}mounted(){this.waveformCanvas=new Ce(this.$refs.wfCanvas),this.waveformCanvas.drawAudio(this.audio)}};c0([S()],N.prototype,"audio",2);N=c0([T({components:{}})],N);const De=N,Ae={class:"waveform"},Fe={ref:"wfCanvas"};function Te(e,t,s,a,o,n){return d(),u("div",Ae,[i("canvas",Fe,null,512)])}var Oe=b(De,[["render",Te],["__scopeId","data-v-8a57a1d8"]]);const Le={f:[[116.6,120.1,123.6,127.1,130.6,134.1,137.6,141.1,144.6,148.1,151.6,155.1,158.6,162.1,165.6,169,172.5,176,179.5,183,186.5,190,193.5,197,200.5,204,207.5,211,214.5,218,221.5,225,228.5,232,235.5,239,242.5,246,249.5,253,256.5,259.9,263.4,266.9,270.4,273.9,277.4,280.9,284.4,287.9],[2385e-7,2812e-7,3063e-7,327e-6,3396e-7,3417e-7,371e-6,5076e-7,8299e-7,.001372,.002127,.00308,.0042,.005453,.006871,.008576,.01063,.01284,.01485,.01638,.0173,.01756,.0171,.01605,.0148,.01377,.01306,.01248,.01178,.01087,.009828,.00873,.007576,.006316,.004969,.00368,.002619,.001861,.001352,9912e-7,7084e-7,4902e-7,3512e-7,2875e-7,2574e-7,2182e-7,1684e-7,1341e-7,1244e-7,1193e-7]],m:[[95.1,98.82,102.5,106.3,110,113.7,117.4,121.1,124.8,128.6,132.3,136,139.7,143.4,147.1,150.9,154.6,158.3,162,165.7,169.4,173.2,176.9,180.6,184.3,188,191.7,195.5,199.2,202.9,206.6,210.3,214,217.8,221.5,225.2,228.9,232.6,236.3,240.1,243.8,247.5,251.2,254.9,258.6,262.4,266.1,269.8,273.5,277.2],[9089e-7,.002198,.004632,.008472,.01326,.01794,.02162,.02392,.02482,.02428,.02234,.01978,.01723,.01449,.01142,.008576,.006679,.005712,.004895,.003772,.002607,.001833,.001476,.001282,.001106,9028e-7,6593e-7,4488e-7,3218e-7,246e-6,1913e-7,133e-6,6664e-8,2085e-8,385e-8,4121e-10,2542e-11,902e-12,184e-13,2158e-16,2324e-17,2414e-15,1537e-13,5625e-12,1183e-10,143e-8,9937e-9,3968e-8,9106e-8,1201e-7]]},xe={f:[[507.9,512.5,517.1,521.7,526.3,530.8,535.4,540,544.6,549.2,553.8,558.4,563,567.5,572.1,576.7,581.3,585.9,590.5,595.1,599.7,604.2,608.8,613.4,618,622.6,627.2,631.8,636.4,640.9,645.5,650.1,654.7,659.3,663.9,668.5,673.1,677.6,682.2,686.8,691.4,696,700.6,705.2,709.7,714.3,718.9,723.5,728.1,732.7],[4256e-7,5718e-7,7402e-7,9474e-7,.001216,.001567,.002008,.002535,.003125,.003746,.004359,.004929,.00544,.005896,.006315,.006728,.00717,.007659,.008172,.008648,.009015,.009232,.009305,.009265,.009134,.008902,.008546,.008058,.007465,.006829,.006219,.005681,.005223,.004815,.004417,.003993,.003531,.003045,.002567,.00213,.001752,.001433,.001161,9206e-7,7048e-7,5189e-7,3724e-7,2681e-7,1979e-7,1481e-7]],m:[[444.8,453.5,462.2,470.9,479.7,488.4,497.1,505.8,514.5,523.2,531.9,540.6,549.4,558.1,566.8,575.5,584.2,592.9,601.6,610.4,619.1,627.8,636.5,645.2,653.9,662.6,671.3,680.1,688.8,697.5,706.2,714.9,723.6,732.3,741.1,749.8,758.5,767.2,775.9,784.6,793.3,802,810.8,819.5,828.2,836.9,845.6,854.3,863,871.7],[1434e-7,2958e-7,5961e-7,.001162,.002001,.00295,.003955,.005155,.006556,.007942,.009073,.009743,.009801,.009316,.008519,.007539,.006422,.005258,.00419,.003317,.002627,.002064,.00156,.001127,8295e-7,6194e-7,4331e-7,2928e-7,2192e-7,192e-6,1708e-7,1321e-7,8308e-8,4569e-8,3726e-8,4765e-8,4765e-8,2943e-8,1087e-8,2391e-9,313e-9,244e-10,1282e-12,44e-10,7575e-11,7819e-10,4804e-9,1757e-8,3826e-8,4959e-8]]},Pe={f:[[1557,1564,1571,1579,1586,1593,1600,1607,1615,1622,1629,1636,1643,1651,1658,1665,1672,1680,1687,1694,1701,1708,1716,1723,1730,1737,1744,1752,1759,1766,1773,1780,1788,1795,1802,1809,1816,1824,1831,1838,1845,1852,1860,1867,1874,1881,1888,1896,1903,1910],[112e-6,1628e-7,2248e-7,2953e-7,3726e-7,4588e-7,5596e-7,6797e-7,8193e-7,9787e-7,.001167,.001403,.001699,.002047,.002417,.002782,.003139,.003507,.003912,.004366,.004853,.005333,.005749,.006055,.006237,.006313,.006317,.006267,.006162,.005994,.005773,.005517,.005227,.004879,.004454,.003964,.003456,.002978,.002549,.002157,.001784,.001427,.001101,822e-6,5989e-7,4302e-7,3103e-7,2307e-7,1787e-7,14e-5]],m:[[1375,1385,1395,1406,1416,1426,1436,1447,1457,1467,1477,1488,1498,1508,1518,1528,1539,1549,1559,1569,1580,1590,1600,1610,1621,1631,1641,1651,1661,1672,1682,1692,1702,1713,1723,1733,1743,1754,1764,1774,1784,1794,1805,1815,1825,1835,1846,1856,1866,1876],[3594e-8,3701e-8,3639e-8,3709e-8,3548e-8,28e-6,1857e-8,1729e-8,3735e-8,9441e-8,2018e-7,3662e-7,5947e-7,9019e-7,.001293,.001741,.002186,.002597,.003007,.003467,.003989,.004543,.005089,.005565,.005906,.006082,.006112,.005998,.005706,.005239,.004674,.004098,.003536,.002955,.002346,.001782,.001363,.001114,9581e-7,8206e-7,6859e-7,5639e-7,453e-6,3502e-7,2598e-7,1871e-7,1376e-7,113e-6,103e-6,8977e-8]]},Me={f:[[2553,2562,2572,2581,2591,2600,2609,2619,2628,2638,2647,2656,2666,2675,2685,2694,2703,2713,2722,2732,2741,2750,2760,2769,2779,2788,2797,2807,2816,2826,2835,2844,2854,2863,2873,2882,2891,2901,2910,2920,2929,2938,2948,2957,2967,2976,2985,2995,3004,3014],[1256e-7,1721e-7,2277e-7,2936e-7,3704e-7,463e-6,5834e-7,7469e-7,9616e-7,.001221,.001506,.001803,.002117,.002465,.002852,.003261,.003655,.004006,.004317,.004606,.004877,.005104,.005242,.005258,.005155,.004967,.004726,.004448,.004134,.003784,.003407,.003015,.002624,.002252,.00192,.001642,.001416,.001229,.001067,9185e-7,7744e-7,632e-6,4959e-7,3755e-7,2781e-7,2046e-7,1502e-7,11e-5,806e-7,5873e-8]],m:[[2392,2405,2417,2429,2442,2454,2467,2479,2492,2504,2517,2529,2542,2554,2566,2579,2591,2604,2616,2629,2641,2654,2666,2679,2691,2703,2716,2728,2741,2753,2766,2778,2791,2803,2815,2828,2840,2853,2865,2878,2890,2903,2915,2928,2940,2952,2965,2977,2990,3002],[2869e-8,2609e-8,2258e-8,2977e-8,579e-7,1154e-7,2067e-7,3241e-7,4535e-7,5956e-7,7721e-7,.001006,.001299,.001634,.00201,.002484,.003113,.003843,.004502,.00494,.005127,.005137,.005066,.004967,.004828,.004605,.004253,.00376,.003164,.002544,.001981,.001523,.001178,9281e-7,7529e-7,6376e-7,5623e-7,4934e-7,4005e-7,2829e-7,1717e-7,98e-6,6493e-8,5315e-8,4427e-8,3261e-8,2291e-8,2114e-8,2584e-8,2866e-8]]},Ie={f:[[-.4538,-.4471,-.4404,-.4337,-.427,-.4203,-.4136,-.4069,-.4002,-.3935,-.3868,-.3801,-.3734,-.3667,-.36,-.3533,-.3466,-.3399,-.3332,-.3265,-.3198,-.3131,-.3064,-.2997,-.293,-.2863,-.2796,-.2729,-.2662,-.2595,-.2528,-.2461,-.2394,-.2327,-.226,-.2193,-.2126,-.2059,-.1992,-.1924,-.1857,-.179,-.1723,-.1656,-.1589,-.1522,-.1455,-.1388,-.1321,-.1254],[.06016,.06715,.07362,.0867,.1163,.1755,.2775,.4279,.6216,.8508,1.119,1.447,1.869,2.404,3.043,3.747,4.465,5.159,5.823,6.475,7.109,7.66,8.011,8.063,7.811,7.351,6.828,6.35,5.946,5.594,5.256,4.901,4.5,4.036,3.519,2.986,2.486,2.057,1.716,1.465,1.285,1.153,1.039,.916,.7722,.6138,.4605,.3311,.2321,.1585]],m:[[-.4582,-.4515,-.4449,-.4382,-.4316,-.4249,-.4182,-.4116,-.4049,-.3982,-.3916,-.3849,-.3783,-.3716,-.3649,-.3583,-.3516,-.3449,-.3383,-.3316,-.325,-.3183,-.3116,-.305,-.2983,-.2916,-.285,-.2783,-.2717,-.265,-.2583,-.2517,-.245,-.2384,-.2317,-.225,-.2184,-.2117,-.205,-.1984,-.1917,-.1851,-.1784,-.1717,-.1651,-.1584,-.1517,-.1451,-.1384,-.1318],[.04963,.0431,.02954,.02191,.02998,.05459,.08537,.1068,.1152,.1302,.1858,.3126,.5226,.8009,1.124,1.497,1.952,2.498,3.121,3.843,4.704,5.656,6.549,7.259,7.793,8.212,8.527,8.751,8.916,8.955,8.69,8.024,7.053,5.98,5.01,4.285,3.799,3.404,2.943,2.376,1.782,1.267,.8801,.6163,.4482,.347,.2885,.257,.236,.2028]]};var Re={pitch:Le,f1:xe,f2:Pe,f3:Me,tilt:Ie};var qe=Object.defineProperty,Be=Object.getOwnPropertyDescriptor,U=(e,t,s,a)=>{for(var o=a>1?void 0:a?Be(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&qe(t,s,o),o};const We={pitch:"Pitch / F0 - Whether the voice sounds high or low.",f1:"Formant F1 - Associated with the vocal area closer to the throat or spine.",f2:"Formant F2 - Controlled by the tongue.",f3:"Formant F3 - Unknown?",tilt:"Spectral Tilt - Whether the voice sounds breathy or creaky."};let F=class extends O{constructor(){super(...arguments);c(this,"featureDescriptions",We);c(this,"stats");c(this,"ml");c(this,"audioDuration")}mounted(){$(".feature").accordion({collapsible:!0,header:".classification-bar",heightStyle:"content",active:!1,animate:{easing:"swing",duration:500}}),$(".feature.pitch").accordion({active:0})}get totalTime(){return this.ml[this.ml.length-1][2]}getColor(e){const t=e[3]?e[3]:0;switch(e[0]){case"female":return`rgba(255,190,200,${t})`;case"male":return`rgba(129,218,255,${t})`;default:return""}}updateAccordion(e){$(`.feature:not(.${e})`).accordion({active:!1})}getOptions(e){return{scales:{y:{ticks:{display:!1}}},plugins:{annotation:{drawTime:"afterDatasetsDraw",annotations:{you:{type:"line",xMin:this.stats.means[e],xMax:this.stats.means[e],borderColor:"rgba(106,100,100,0.47)",borderWidth:2,label:{enabled:!0,position:"start",content:"You're Here",color:"#ffe3be",backgroundColor:"rgba(106,100,100,0.8)"}}}}}}}getCurveData(e){const t=Re[e];return{datasets:[{label:"Masculine Range",data:t.m[0].map((a,o)=>({x:a,y:t.m[1][o]})),borderColor:"#81daff",pointRadius:0,showLine:!0,fill:"origin",backgroundColor:"rgba(129,218,255,0.5)"},{label:"Feminine Range",data:t.f[0].map((a,o)=>({x:a,y:t.f[1][o]})),borderColor:"#ffbec8",pointRadius:0,showLine:!0,fill:"origin",backgroundColor:"rgba(255,190,200,0.5)"}]}}};U([S()],F.prototype,"stats",2);U([S()],F.prototype,"ml",2);U([S()],F.prototype,"audioDuration",2);F=U([T({components:{ScatterChart:$0,DoughnutChart:C0}})],F);const Ve=F,q=e=>(I("data-v-2555b081"),e=e(),R(),e),He={id:"ClassificationResults"},je={key:0,class:"audio-too-short-warning"},Ne=q(()=>i("div",{class:"head"},[i("i",{class:"fas fa-exclamation-triangle"}),i("span",null,"Audio Too Short"),i("i",{class:"fas fa-exclamation-triangle"})],-1)),Ee=q(()=>i("div",{class:"expl"},"Please record at least 10 seconds for more accuracy.",-1)),Ue={class:"expl"},ze=q(()=>i("div",{class:"title"},"Full Audio Statistics",-1)),Ge={key:1,class:"features-bar"},Ke={class:"description"},Ye={class:"name"},Je={class:"desc"},Xe=["onClick"],Qe={class:"chart-wrapper"},Ze={key:2,class:"no-features"},et=q(()=>i("div",{class:"title"},"Machine Learning Classification",-1)),tt={key:3,class:"feature"},st=q(()=>i("div",{class:"description"},[i("span",{class:"name"},"Machine Learning"),i("span",{class:"desc"},"How your voice might sound like to a robot.")],-1)),ot={class:"classification-bar ml-bar"},at={key:4,class:"no-features"};function nt(e,t,s,a,o,n){const r=v("ScatterChart");return d(),u("div",He,[e.audioDuration<10?(d(),u("div",je,[Ne,Ee,i("div",Ue,"(You're audio was "+w(e.audioDuration.toFixed(1))+" seconds long)",1)])):m("",!0),ze,e.stats.fem_prob?(d(),u("div",Ge,[(d(),u(P,null,H(["pitch","f1","f2","f3","tilt"],l=>i("div",{class:C(["feature",l]),ref_for:!0,ref:"feature"},[i("div",Ke,[i("span",Ye,w(e.featureDescriptions[l].split(" - ")[0]),1),i("span",Je,w(e.featureDescriptions[l].split(" - ")[1]),1)]),i("div",{class:"classification-bar unselectable clickable",onClick:p=>e.updateAccordion(l)},[i("span",{class:"f fbox-vcenter",style:M({width:`${(e.stats.fem_prob[l]*100).toFixed(0)}%`})},[i("span",{class:C(["percentage-sub",{right:e.stats.fem_prob[l]<.5}])},w((e.stats.fem_prob[l]*100).toFixed(0))+"% ",3)],4)],8,Xe),i("div",Qe,[y(r,{height:200,chartData:e.getCurveData(l),options:e.getOptions(l),style:{"min-height":"200px"}},null,8,["chartData","options"])])],2)),64))])):(d(),u("div",Ze," Sorry, audio is too short, no frequency feature was detected. ")),et,e.ml.length>0?(d(),u("div",tt,[st,i("div",ot,[(d(!0),u(P,null,H(e.ml,l=>(d(),u("div",{class:"frame",style:M({width:`${(l[2]-l[1])/e.totalTime*100}%`,background:e.getColor(l)})},null,4))),256))])])):(d(),u("div",at,"Sorry, our model failed to detect voice on this audio."))])}var rt=b(Ve,[["render",nt],["__scopeId","data-v-2555b081"]]);var it=Object.defineProperty,lt=Object.getOwnPropertyDescriptor,ct=(e,t,s,a)=>{for(var o=a>1?void 0:a?lt(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&it(t,s,o),o};let Y=class extends O{constructor(){super(...arguments);c(this,"dropped",!1);c(this,"activeTab",1);c(this,"audio",null);c(this,"stats",null);c(this,"ml");c(this,"spec",null);c(this,"specSr");c(this,"freqArrays",null);c(this,"recorderCompatible",navigator.mediaDevices);c(this,"recorder",null);c(this,"recordChunks",[])}async loadFile(e){const t=new j,s=r0("spec.local").val;console.log(`File Dropped: ${e.name}
- LastModified: ${e.lastModified}
- Size: ${e.size}
- Type: ${e.type}`),z0("/process",{file:e,params:{with_mel_spect:!s}}).then(async r=>{let l=await r.json();this.stats=l.result,this.ml=l.ml,s||(this.specSr=l.spec_sr,this.spec=U0(l.spec.bytes,l.spec.shape)),this.freqArrays=E0(l.freq_array.bytes,l.freq_array.shape),console.log(l)});const a=await e.arrayBuffer(),o=new AudioContext({sampleRate:16e3});this.audio=await o.decodeAudioData(a);const n=this.audio.getChannelData(0);t.log(`Audio Loaded:
- Sample Rate: ${this.audio.sampleRate} Hz
- Array Length: ${this.audio.length}
- Duration: ${this.audio.duration} sec
- Number of Channels: ${this.audio.numberOfChannels}
`),s&&(this.spec=await i0(n,16e3),this.specSr=16e3,t.log("Spectrogram - Mel STFT calculation done"))}async onDrop(e){if(e.preventDefault(),this.dropped=!0,!(e.dataTransfer&&e.dataTransfer.items))return;const t=e.dataTransfer.items.length;if(t>1)return Q.error(`Only one file can be analyzed at a time, you dropped ${t}`);const s=e.dataTransfer.items[0];if(s.kind!="file")return Q.error(`Error: The item dropped must be a file, not a ${s.kind}`);await this.loadFile(s.getAsFile())}async btnRecord(){if(this.recorder){this.recorder.stop(),this.recorder=null;return}const e=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1}});this.recorder=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"}),this.recorder.addEventListener("dataavailable",t=>{this.recordChunks.push(t.data)}),this.recorder.addEventListener("stop",()=>{const t=new Blob(this.recordChunks,{type:"audio/webm;codecs=opus"});this.loadFile(new File([t],"recorded-audio.webm"))}),this.recorder.start()}};Y=ct([T({components:{ClassificationResults:rt,Waveform:Oe,Spectrogram:de,Loading:we}})],Y);const dt=Y,ut=e=>(I("data-v-2631b99b"),e=e(),R(),e),ht={id:"home",ref:"el",class:"fbox-v"},pt={key:0,class:"usage"},ft=L(" Welcome to the voice analysis tool! "),_t=ut(()=>i("br",null,null,-1)),mt=L(" Drop or record an audio to analyze. "),vt=[ft,_t,mt],gt={key:0,class:"drop-label"},yt={key:0,class:"drop-label"},bt={key:1,class:"drop-label"},wt={key:3,class:"results"},$t={class:"result-nav unselectable anim"},Ct={key:1,class:"result-tab card shadow"},St={key:2,class:"result-tab card shadow"};function kt(e,t,s,a,o,n){const r=v("Loading"),l=v("Waveform"),p=v("Spectrogram"),h=v("ClassificationResults");return d(),u("div",ht,[e.audio?m("",!0):(d(),u("div",pt,vt)),e.audio?m("",!0):(d(),u("div",{key:1,class:"drop-box unselectable shadow",onDragover:t[0]||(t[0]=_=>_.preventDefault()),onDrop:t[1]||(t[1]=(..._)=>e.onDrop&&e.onDrop(..._))},[e.dropped?(d(),D(r,{key:1})):(d(),u("span",gt,"Drop Here"))],32)),!e.audio&&e.recorderCompatible?(d(),u("div",{key:2,class:"drop-box unselectable shadow record clickable",onClick:t[2]||(t[2]=(..._)=>e.btnRecord&&e.btnRecord(..._))},[e.recorder?(d(),u("span",bt,"Stop Recording")):(d(),u("span",yt,"Record"))])):m("",!0),e.audio?(d(),u("div",wt,[e.audio?(d(),D(l,{key:0,audio:e.audio},null,8,["audio"])):m("",!0),i("div",$t,[i("div",{class:C(["tab-button spectrogram",{sel:e.activeTab===1}]),onClick:t[3]||(t[3]=()=>e.activeTab=1)}," Spectrogram ",2),i("div",{class:C(["tab-button",{sel:e.activeTab===2}]),onClick:t[4]||(t[4]=()=>e.activeTab=2)}," Classification ",2),i("div",{class:C(["tab-button",{sel:e.activeTab===3}]),onClick:t[5]||(t[5]=()=>e.activeTab=3)}," Position ",2)]),i("div",{class:"result-tab card shadow",style:M(e.activeTab===1?{}:{display:"none"})},[e.spec?(d(),D(p,{key:0,spec:e.spec,sr:e.specSr,"freq-arrays":e.freqArrays},null,8,["spec","sr","freq-arrays"])):(d(),D(r,{key:1}))],4),e.activeTab===2?(d(),u("div",Ct,[e.stats&&e.audio?(d(),D(h,{key:0,stats:e.stats,ml:e.ml,"audio-duration":e.audio.duration},null,8,["stats","ml","audio-duration"])):(d(),D(r,{key:1}))])):m("",!0),e.activeTab===3?(d(),u("div",St)):m("",!0)])):m("",!0)],512)}var Dt=b(dt,[["render",kt],["__scopeId","data-v-2631b99b"]]);const At={id:"about",class:"card shadow"},Ft=t0({setup(e){return X([1,1,1,1,0,0,0,0]).rfft().print(),(s,a)=>(d(),u("div",At," This is an about page. "))}});var Tt=b(Ft,[["__scopeId","data-v-191d5f3e"]]);const Ot={name:"HyInput",props:{modelValue:String,placeholder:String},emits:["update:modelValue","input"],methods:{passInput(e){this.$emit("update:modelValue",e),this.$emit("input",e)}}},Lt=["value"],xt={key:0,class:"hy-input-placeholder"},Pt={for:"hy-input-inner"};function Mt(e,t,s,a,o,n){return d(),u("div",{class:C(["hy-input",{"has-text":s.modelValue,anim:s.placeholder}])},[i("input",S0({id:"hy-input-inner",class:"hy-input-inner",value:s.modelValue,onInput:t[0]||(t[0]=r=>n.passInput(r.target.value))},e.$attrs,{autocomplete:"off"}),null,16,Lt),s.placeholder?(d(),u("div",xt,[i("label",Pt,w(s.placeholder),1)])):m("",!0)],2)}var It=b(Ot,[["render",Mt],["__scopeId","data-v-1f47755c"]]);var Rt=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,Bt=(e,t,s,a)=>{for(var o=a>1?void 0:a?qt(t,s):t,n=e.length-1,r;n>=0;n--)(r=e[n])&&(o=(a?r(t,s,o):r(o))||o);return a&&o&&Rt(t,s,o),o};let J=class extends O{constructor(){super(...arguments);c(this,"options",z);c(this,"marked",k0)}getClass(e){const t={modified:e.modified};return t[e.type]=!0,t}reset(){D0.confirm("Do you really want to reset?").then(()=>{z.forEach(e=>e.reset()),this.$forceUpdate()})}};J=Bt([T({components:{HyInput:It}})],J);const Wt=J,d0=e=>(I("data-v-03154754"),e=e(),R(),e),Vt={id:"Settings",class:"card shadow"},Ht=d0(()=>i("div",{id:"text"},[i("div",{id:"title"},"Settings"),i("div",{id:"subtitle"},"You can toggle things here!")],-1)),jt={id:"options"},Nt=["innerHTML"],Et={key:0},Ut={key:1},zt={key:2,class:"modified-text"},Gt=d0(()=>i("span",null,"Modified!",-1)),Kt=L(),Yt=L("Default is "),Jt=L("Reset");function Xt(e,t,s,a,o,n){const r=v("el-switch"),l=v("hy-input"),p=v("el-button");return d(),u("div",Vt,[Ht,i("div",jt,[(d(!0),u(P,null,H(e.options,h=>(d(),u("div",{class:C(e.getClass(h))},[i("div",{class:"desc",innerHTML:e.marked(h.desc)},null,8,Nt),h.type==="boolean"?(d(),u("div",Et,[y(r,{modelValue:h.val,"onUpdate:modelValue":_=>h.val=_,"active-color":"pink"},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0),h.type==="string"?(d(),u("div",Ut,[y(l,{modelValue:h.val,"onUpdate:modelValue":_=>h.val=_},null,8,["modelValue","onUpdate:modelValue"])])):m("",!0),h.modified?(d(),u("div",zt,[Gt,Kt,i("span",null,[Yt,i("code",null,w(h.def),1)])])):m("",!0)],2))),256))]),y(p,{type:"danger",plain:"",round:"",onClick:e.reset},{default:V(()=>[Jt]),_:1},8,["onClick"])])}var Qt=b(Wt,[["render",Xt],["__scopeId","data-v-03154754"]]);const Zt=[{path:"/",name:"Home",component:Dt},{path:"/about",name:"About",component:Tt},{path:"/settings",name:"Settings",component:Qt}],es=A0({history:F0(),routes:Zt});a0.register(...T0);a0.register(O0);L0(V0).use(es).use(x0).mount("#app");
